<div class="menu-container">
    <div class="menu-header">
        <button onclick="resetDashboard()" class="home-btn">üè† DASHBOARD HOME</button>
        <div id="screen-name" class="current-screen">Home</div>
    </div>

    <div class="menu-section">
        <h3>SITE & IDENTITY</h3>
        <ul class="menu-list">
            <li onclick="loadFrame('blog_manager.html', 'Blog Management')">Blog Management</li>
            <li onclick="loadFrame('franchise_manager.html', 'Franchise Manager')">Franchise Manager</li>
            <li onclick="loadFrame('parent_manager.html', 'Parent Management')">Parent Management</li>
            <li onclick="loadFrame('student_manager.html', 'Student Management')">Student Management</li>
            <li onclick="loadFrame('teacher_manager.html', 'Teacher Management')">Teacher Management</li>
        </ul>
    </div>
</div>

<script>
    // This variable stays alive as long as the menu is loaded
    let lastAbortController = null;

    function loadFrame(url, name) {
        // 1. If there's an old request still hanging, kill it now
        if (lastAbortController) {
            lastAbortController.abort();
        }

        // 2. Create a new controller for the NEW click
        lastAbortController = new AbortController();

        // UI Updates
        const indicator = document.getElementById('screen-name');
        if (indicator) indicator.textContent = name;
        
        // Reach into the main index.html to find the elements
        const parentDoc = window.parent.document;
        const frame = parentDoc.getElementById('main-frame');
        const contentInner = parentDoc.getElementById('content-inner');

        if (contentInner) contentInner.style.display = 'none';

        // 3. Set the src directly. 
        // Adding the timestamp ensures the browser doesn't use a 'stuck' pipe.
        frame.src = url + '?v=' + Date.now();
    }

    function resetDashboard() {
        if (lastAbortController) lastAbortController.abort();
        const parentDoc = window.parent.document;
        const frame = parentDoc.getElementById('main-frame');
        const contentInner = parentDoc.getElementById('content-inner');
        const indicator = document.getElementById('screen-name');

        frame.src = 'about:blank';
        if (contentInner) contentInner.style.display = 'block';
        if (indicator) indicator.textContent = 'Home';
    }
</script>
