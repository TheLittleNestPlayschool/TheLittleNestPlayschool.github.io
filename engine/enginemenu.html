<div class="menu-container">
    <div class="menu-header">
        <button onclick="resetDashboard()" class="home-btn">üè† DASHBOARD HOME</button>
        <div id="screen-name" class="current-screen">Home</div>
    </div>

    <div class="menu-section">
        <h3>SITE & IDENTITY</h3>
        <ul class="menu-list">
            <li onclick="loadModule('blog_manager.html', 'Blog Management')">Blog Management</li>
            <li onclick="loadModule('franchise_manager.html', 'Franchise Manager')">Franchise Manager</li>
            <li onclick="loadModule('parent_manager.html', 'Parent Management')">Parent Management</li>
            <li onclick="loadModule('student_manager.html', 'Student Management')">Student Management</li>
            <li onclick="loadModule('teacher_manager.html', 'Teacher Management')">Teacher Management</li>
        </ul>
    </div>
</div>

<script>
    // Global controller to kill pending Xano/Hostinger requests
    let activeController = null;

    function loadModule(url, name) {
        // 1. Abort previous click immediately
        if (activeController) {
            activeController.abort();
        }

        // 2. Create fresh signal for this specific load
        activeController = new AbortController();
        const { signal } = activeController;

        // UI Updates
        const indicator = document.getElementById('screen-name');
        if (indicator) indicator.textContent = name;
        
        // Use window.parent to reach the dashboard shell
        const parentDoc = window.parent.document;
        const contentInner = parentDoc.getElementById('content-inner');
        const mainFrame = parentDoc.getElementById('main-frame');

        if (contentInner) contentInner.style.display = 'none';

        // 3. Clear the frame so the browser can drop the old connection
        mainFrame.src = 'about:blank';

        // 4. Load the new module
        const freshUrl = url + '?v=' + Date.now();
        
        // Small delay ensures the 'abort' signals are processed by the network tab
        setTimeout(() => {
            if (!signal.aborted) {
                mainFrame.src = freshUrl;
            }
        }, 50);
    }

    function resetDashboard() {
        if (activeController) activeController.abort();
        const parentDoc = window.parent.document;
        const mainFrame = parentDoc.getElementById('main-frame');
        const contentInner = parentDoc.getElementById('content-inner');
        const indicator = document.getElementById('screen-name');

        mainFrame.src = 'about:blank';
        if (contentInner) contentInner.style.display = 'block';
        if (indicator) indicator.textContent = 'Home';
    }
</script>
