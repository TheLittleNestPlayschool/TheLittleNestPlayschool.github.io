<div class="menu-container">
    <div class="menu-header">
        <button onclick="resetDashboard()" class="home-btn">üè† DASHBOARD HOME</button>
        <div id="screen-name" class="current-screen">Home</div>
    </div>

    <div class="menu-section">
        <h3>SITE & IDENTITY</h3>
        <ul class="menu-list">
            <li onclick="loadFrame('blog_manager.html', 'Blog Management')">Blog Management</li>
            <li onclick="loadFrame('franchise_manager.html', 'Franchise Manager')">Franchise Manager</li>
            <li onclick="loadFrame('parent_manager.html', 'Parent Management')">Parent Management</li>
            <li onclick="loadFrame('student_manager.html', 'Student Management')">Student Management</li>
            <li onclick="loadFrame('teacher_manager.html', 'Teacher Management')">Teacher Management</li>
        </ul>
    </div>
    </div>

<script>
    // 1. Define the controller outside the function so it persists between clicks
    let menuAbortController = null;

    function loadFrame(url, name) {
        // 2. If a request is already running, KILL IT
        if (menuAbortController) {
            menuAbortController.abort();
            console.log("Aborted previous connection to free browser slot.");
        }

        // 3. Create a fresh controller for the new click
        menuAbortController = new AbortController();
        const signal = menuAbortController.signal;

        // UI Updates
        const indicator = document.getElementById('screen-name');
        if (indicator) indicator.textContent = name;
        
        const contentInner = window.parent.document.getElementById('content-inner');
        if (contentInner) contentInner.style.display = 'none';

        const frame = window.parent.document.getElementById('main-frame');
        
        // 4. Reset the frame to clear the previous document
        frame.src = 'about:blank';

        // 5. Load the new URL with a timestamp [cite: 2026-01-13]
        // We wrap this in a check to make sure we didn't JUST abort it
        const freshUrl = url + '?v=' + Date.now();
        
        setTimeout(() => {
            if (!signal.aborted) {
                frame.src = freshUrl;
            }
        }, 10);
    }

    function resetDashboard() {
        if (menuAbortController) menuAbortController.abort();
        const frame = window.parent.document.getElementById('main-frame');
        frame.src = 'about:blank';
        const contentInner = window.parent.document.getElementById('content-inner');
        if (contentInner) contentInner.style.display = 'block';
        const indicator = document.getElementById('screen-name');
        if (indicator) indicator.textContent = 'Home';
    }
</script>
